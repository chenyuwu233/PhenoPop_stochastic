# PhenoPop_stochastic

PhenoPop End-point and Live cell method experiments.

This repository contains the MATLAB scripts of the experiments presented in the article Using birth-death processes to infer tumor subpopulation structure from live-cell imaging drug screening data. In particular, this repository contains the following directories:
    * main function: This directory contains the main objective function and in silico data generating function for live-cell imaging method.
    * Energy_dist_test: This directory contains the script 'ED_test.m' script, which is necessary for reproducing the energy distance experiment in the manuscript. 
    * In silico experiment: This directory contains 5 sub-directories corresponding to 5 differents experiments presented in the manuscript.
        
        * 2 subpopulation experiments: This directory contains code necessary to reproduce the illustrative experiment for two subpopulations, as described in the manuscript. The main script, 'PhenoPop_sto_2_pop.m', generates bootstrapping experiment results from randomly selected true parameters. To visualize the results, use the 'Plot_CI_EP_LC.m' script. To reproduce the confidence interval width results, use the 'plot_CI_width.m' script, which depends on another git project 'sigstar'. 
        * 3 subpopulation experiments: This directory contains code necessary to reproduce the illustrative experiment for three subpopulations, as described in the manuscript. The main script, 'PhenoPop_sto_3_pop.m', generates bootstrapping experiment results from randomly selected true parameters. To visualize the results, use the 'ploting_multi.m' script.
        * Challenge Condition Noise: This directory contains code necessary to reproduce the challenge condition: High observation noise experiment, as described in the manuscript. The main script, 'CC_Noise.m', generates bootstrapping experiment results from randomly selected true parameters with selecting observation noise level. To visualize the result, use the 'Plot_CI_no.m' script. To reproduce the confidence interval width results, use the 'plot_CI_width.m' script, which depends on another git project 'sigstar'. 
        * Challenge Condition Similarity: This directory contains code necessary to reproduce the challenge condition: Similar subpopulation experiment, as described in the manuscript. The main script, 'CC_Similarity.m', generates bootstrapping experiment results from randomly selected true parameters with selecting initial proportion. To visualize the result, use the 'Plot_CI_cg.m' script.
        * Challenge Condition Unbalance: This directory contains code necessary to reproduce the challenge condition: Unbalanced initial proportion experiment, as described in the manuscript. The main script, 'CC_Unbalance.m', generates bootstrapping experiment results from randomly selected true parameters with selecting E2 value. To visualize the result, use the 'Plot_CI_hp.m' script.
        * In every experiment, we provided existing experiment results in the sub-directory 'Result'.
    
    * In vitro experiment: This directory contains the script 'Performance_test_P.m', which can fit all three methods (PhenoPop, PhenoPop endpoints, PhenoPop live-cell imaging) to the practical data [BF_11,BF_12,BF_21,BF_41] and compute the AIC.
    * Manuscript Plot: This directory contains all the plots in the manuscript. 
 
 
 Abstract: Tumor heterogeneity is a complex and widely recognized trait that poses significant challenges in developing effective cancer therapies. Characterizing the heterogeneous subpopulation structure within a tumor will enable a more precise and successful treatment strategy for cancer therapy. A possible strategy to uncover the structure of subpopulations is to examine how they respond differently to different drugs. For instance, PhenoPop was proposed as a means to unravel the subpopulation structure within a tumor from high-throughput drug screening data. However, the deterministic nature of PhenoPop restricts the model fit and the information it can extract from the data. As an advancement, we proposed a stochastic model based on the linear birth-death process to address this limitation. Our model can formulate a dynamic variance along the horizon of the experiment so that the model uses more information from the data to provide a more robust estimation. In addition, the newly proposed model can be readily adapted to situations where the experimental data exhibits a positive time correlation. We concluded our study by testing our model on simulated data (In Silico) and experimental data (In Vitro), which supports our argument about its advantages.
